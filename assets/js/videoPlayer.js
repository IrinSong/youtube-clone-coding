(()=>{const e=document.getElementById("videoContainer"),t=document.querySelector("video"),n=document.getElementById("videoControls"),d=document.getElementById("play"),u=document.getElementById("mute"),l=document.getElementById("currentTime"),o=document.getElementById("totalTime"),m=document.getElementById("volume"),r=document.getElementById("timeline"),i=document.getElementById("fullScreen"),a=document.getElementById("commentInput");let c=null,s=null,v=.5;t.volume=v;const E=e=>{t.paused?t.play():t.pause(),d.innerText=t.paused?"play_arrow":"pause"},g=e=>new Date(1e3*e).toISOString().substring(11,19),y=()=>n.classList.remove("showing"),T=()=>{document.fullscreenElement?(document.exitFullscreen(),i.innerText="fullscreen"):(e.requestFullscreen(),i.innerText="fullscreen_exit")};d.addEventListener("click",E),u.addEventListener("click",(e=>{t.muted?t.muted=!1:t.muted=!0,u.innerText=t.muted?"volume_off":"volume_up",m.value=t.muted?0:v})),m.addEventListener("input",(e=>{const{target:{value:n}}=e;t.muted&&(t.muted=!1,u.innerText="volume_off"),v=n,t.volume=n})),t.addEventListener("click",E),t.addEventListener("loadedmetadata",(()=>{o.innerText=g(Math.floor(t.duration)),r.max=Math.floor(t.duration)})),t.addEventListener("timeupdate",(()=>{l.innerText=g(Math.floor(t.currentTime)),r.value=Math.floor(t.currentTime)})),t.addEventListener("ended",(()=>{const{id:t}=e.dataset;fetch(`/api/videos/${t}/view`,{method:"POST"})})),e.addEventListener("mousemove",(()=>{c&&(clearTimeout(c),c=null),s&&(clearTimeout(s),s=null),n.classList.add("showing"),s=setTimeout(y,3e3)})),e.addEventListener("mouseleave",(()=>y())),r.addEventListener("input",(e=>{const{target:{value:n}}=e;t.currentTime=n})),i.addEventListener("click",T),document.addEventListener("keydown",(e=>{e.target!==a&&("Space"===e.code?(e.preventDefault(),E()):70===e.keyCode&&T())}))})();